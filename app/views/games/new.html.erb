<%= render 'shared/navbar' %>

<div class="container">
  <h1 class="mt-3"> Create a new game:</h1>
  <hr>
  <div class="custom-form">
    <div class="col-12 users-search">
      <%= simple_form_for :search, url: new_game_path, method: :get do |f| %>
        <div class="search-form-control form-group">
          <%= f.input :username, input_html: { value: @search_term },
            label: false,
            classe: "form-control",
            placeholder: "Find your opponent" %>
          <%= f.submit "Search", class: "btn btn-cta", id:"btn-small" %>
        </div>
      <% end %> 
      <%= simple_form_for(@game) do |f| %>
        <%= f.submit "Create game", class: "btn btn-cta", id:"btn-small" %>
        <div class="game-inline-block">
          <div class="game-info">
            <h4>Grid size</h4> 
            <%= f.input :grid_size, label: false %>
          </div>
          <div class="users-list" data-controller="radio-button">
            <h4>Users</h4>
            <%= f.association :users,
              as: :radio_buttons,
              label: "",
              collection: @users.map { |user|
                [raw(
                  "<div class='notification'>
                    #{user.photo.key.nil? ? image_tag('leader.png', class: 'avatar-large') : cl_image_tag(user.photo.key, class: 'avatar-large')}
                    <div class='notification-content'>
                      <p>#{user.username}</p>
                    </div>
                  </div>"
                  ), user.id
                ]
              },
              item_label_class: "mb-0",
              input_html: {
                class: "sr-only",
                data: {
                  action: "radio-button#toggleCheckedClass",
                  radio_button_target: "radioBtn"
                }
              },
              wrapper_class: "horizontal-scroll py-0",
              item_wrapper_class: "col-7 col-md-5 col-lg-3 custom--media__miniature text-center" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
